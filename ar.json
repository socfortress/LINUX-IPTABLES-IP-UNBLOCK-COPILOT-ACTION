{
  "copilot_action_name": "LINUX-IPTABLES-IP-UNBLOCK-COPILOT-ACTION",
  "description": "Unblocks a specified IPv4 address from iptables by removing an INPUT -s <IP> -j DROP rule if present. Validates IP format, logs outcomes (unblocked / not_blocked / failed / error), and writes a single NDJSON object atomically to the Active Response log with .new fallback.",
  "technology": "Linux",
  "icon": "linux",
  "script_parameters": [
    {
      "name": "IP",
      "type": "string",
      "required": true,
      "description": "IPv4 address to unblock from iptables (e.g., 203.0.113.10).",
      "default": null,
      "arg_position" : "1"
    },
    {
      "name": "ARLog",
      "type": "string",
      "required": false,
      "description": "Active Response NDJSON output path (atomic overwrite; falls back to .new if locked).",
      "default": "/var/ossec/active-response/active-responses.log"
    },
    {
      "name": "LogPath",
      "type": "string",
      "required": false,
      "description": "Path to the rotating human-readable script log.",
      "default": "/tmp/Unblock-IP-iptables.log"
    },
    {
      "name": "LogMaxKB",
      "type": "integer",
      "required": false,
      "description": "Maximum size of LogPath (KB) before rotation.",
      "default": 100
    },
    {
      "name": "LogKeep",
      "type": "integer",
      "required": false,
      "description": "Number of rotated log files to keep.",
      "default": 5
    }
  ],
  "repo_url": "https://raw.githubusercontent.com/socfortress/LINUX-IPTABLES-IP-UNBLOCK-COPILOT-ACTION/refs/heads/main",
  "script_name": "IPTABLES-IP-UnBlock.sh",
  "version": "1.0.0",
  "last_updated": "2025-08-23T00:00:00Z"
}
